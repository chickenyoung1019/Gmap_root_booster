html,body { height:100%; }
body { margin:0; padding:0; overflow:hidden; font-family:'Inter',system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN","Noto Sans JP","Yu Gothic","Meiryo",sans-serif; }
.wrapper { display:flex; flex-direction:column; height:100vh; width:100vw; }
#map { flex:1 1 auto; height:100%; width:100%; z-index:1; }

/* 下部リストパネル */
.list-panel{
  position:absolute; bottom:0; left:0; right:0; z-index:10; background:#fff;
  border-top-left-radius:1.5rem; border-top-right-radius:1.5rem;
  box-shadow:0 -4px 12px rgba(0,0,0,.15);
  transform:translateY(calc(100% - 4.5rem)); transition:transform .3s ease-in-out;
  display:flex; flex-direction:column; height:90vh; will-change:transform;
}
.list-panel.open{ transform:translateY(0); }
.handle-bar{ width:3rem; height:.25rem; background:#ccc; border-radius:.25rem; margin:.5rem auto 1rem; }
.list-header{ padding:.5rem 1rem; text-align:center; cursor:pointer; }
.list-content{ flex:1 1 auto; overflow-y:auto; padding:.75rem 1rem; background:#f7f7f7; }

.poi-card{ display:flex; align-items:center; gap:.75rem; padding:.1rem; border-radius:.5rem; background:#fff; box-shadow:0 1px 3px rgba(0,0,0,.1); margin-bottom:.15rem; cursor:grab; }
.poi-card:hover{ background:#f9f9f9; box-shadow:0 2px 6px rgba(0,0,0,.15); transform:translateY(-2px); }
.badge{ min-width:2.25rem; height:2.25rem; display:grid; place-items:center; font-weight:700; color:#fff; border-radius:9999px; font-size:.875rem; background:#4285F4; border:2px solid #fff; }
.poi-content{ display:flex; flex-direction:column; flex:1 1 auto; }
.poi-name{ font-weight:600; font-size:1rem; color:#333; }
.poi-meta{ font-size:.75rem; color:#777; }
.tw-badge{ display:inline-block; margin-left:.5rem; padding:.125rem .5rem; border-radius:.25rem; background:#fff3e0; color:#F8B400; font-weight:700; font-size:.75rem; border:1px solid #ffcc80; }

/* 画面上部のUI */
.header{ position:absolute; top:1rem; left:1rem; right:1rem; z-index:1000; display:flex; flex-direction:column; gap:.5rem; align-items:center; }
.search-bar{ width:100%; background:#fff; border-radius:2rem; padding:.0rem; box-shadow:0 2px 4px rgba(0,0,0,.2); display:flex; align-items:center; gap:.5rem; color:#777; }
.search-input{ flex:1; border:none; outline:none; font-size:1.2rem; color:#333; padding:.5rem .75rem; }
.btn-container{ display:flex; align-items:center; gap:.5rem; width:100%; overflow-x:auto; white-space:nowrap; -webkit-overflow-scrolling:touch; }
.header-item{ display:inline-flex; align-items:center; justify-content:center; height:2rem; padding:0 1rem; border-radius:9999px; background:#fff; color:#333; font-size:.875rem; font-weight:500; box-shadow:0 1px 3px rgba(0,0,0,.1); cursor:pointer; flex-shrink:0; }

/* 番号バッジ（常時表示ツールチップ用） */
.idx-tip{
  background:#1d4ed8; color:#fff; font-weight:700; font-size:12px;
  border-radius:9999px; padding:2px 6px; border:2px solid #fff;
  box-shadow:0 1px 3px rgba(0,0,0,.2);
}

/* アクティブ強調（ピンの赤縁） */
.leaflet-marker-icon.active {
  filter: drop-shadow(0 0 1px #ff0000) drop-shadow(0 0 1px #ff0000) drop-shadow(0 0 1px #ff0000);
}

/* Leaflet のポップアップ（ピンの吹き出し） */
.leaflet-popup-content {
  font-size: 1.05rem;  /* デフォルト12px→14px相当 */
  font-weight: 600;    /* 太字寄りに */
}

/* S/G バッジ（LeafletのTooltipを利用） */
.sg-tip-start {
  background:#22c55e; color:#fff; font-weight:700; font-size:12px;
  border-radius:9999px; padding:2px 6px; border:2px solid #fff;
  box-shadow:0 1px 3px rgba(0,0,0,.2);
}
.sg-tip-goal {
  background:#ef4444; color:#fff; font-weight:700; font-size:12px;
  border-radius:9999px; padding:2px 6px; border:2px solid #fff;
  box-shadow:0 1px 3px rgba(0,0,0,.2);
}

/* 一括/コピペパネル */
#bulkPanel {
  position: absolute; left: 1rem; right: 1rem; top: 4.25rem; z-index: 1001;
  background: #fff; border-radius: .75rem; box-shadow: 0 10px 24px rgba(0,0,0,.18);
  padding: .75rem; display: none;
}
#bulkPanel .row { display:flex; gap:.5rem; flex-wrap:wrap; align-items:center; margin-bottom:.5rem; }
#bulkPanel textarea { width:100%; min-height: 37rem; border:1px solid #e5e7eb; border-radius:.5rem; padding:.5rem; font-size:.95rem; }
#bulkPanel .pill { padding:.4rem .8rem; border:1px solid #dadce0; border-radius:9999px; background:#fff; cursor:pointer; }
#bulkPanel .pill:hover { background:#f5f7ff; }
#bulkPanel small { color:#6b7280; }

/* 一括プレビューリスト */
#bulkPreview {
  max-height: 40rem;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

/* 一括プレビュー：第2ヘッダー（固定） */
.bulk-subheader {
  position: sticky;
  top: 0;
  z-index: 10;
  display: flex;
  gap: .5rem;
  padding: .5rem .75rem;
  background: #f9fafb;
  border-bottom: 1px solid #e5e7eb;
  margin-bottom: .75rem;
}

.subheader-btn {
  padding: .35rem .75rem;
  font-size: .85rem;
  border: 1px solid #d1d5db;
  border-radius: .375rem;
  background: #fff;
  cursor: pointer;
  color: #374151;
}

.subheader-btn:hover {
  background: #f3f4f6;
}

#bulkPreviewList {
  display: flex;
  flex-direction: column;
  gap: .5rem;
}

.bulk-preview-card {
  display: flex;
  align-items: center;
  gap: .5rem;
  padding: .75rem;
  background: #fff;
  border: 1px solid #e5e7eb;
  border-radius: .5rem;
}

.bulk-preview-card:hover {
  background: #f9fafb;
}

.bulk-checkbox {
  width: 1.25rem;
  height: 1.25rem;
  cursor: pointer;
  flex-shrink: 0;
}

.bulk-address {
  flex: 1;
  font-size: .95rem;
  color: #333;
}

.bulk-edit-btn {
  padding: .35rem .6rem;
  border: 1px solid #e5e7eb;
  border-radius: .375rem;
  background: #fff;
  color: #2563eb;
  cursor: pointer;
  font-size: .875rem;
  flex-shrink: 0;
}

.bulk-add-one-btn {
  padding: .35rem .6rem;
  border: 1px solid #e5e7eb;
  border-radius: .375rem;
  background: #fff;
  color: #22c55e;
  cursor: pointer;
  font-size: .875rem;
  flex-shrink: 0;
  font-weight: 600;
}

.bulk-add-one-btn:hover {
  background: #f0fdf4;
  border-color: #22c55e;
}

.bulk-delete-btn {
  padding: .35rem .6rem;
  border: 1px solid #e5e7eb;
  border-radius: .375rem;
  background: #fff;
  color: #b91c1c;
  cursor: pointer;
  font-size: .875rem;
  flex-shrink: 0;
}

.bulk-delete-btn:hover {
  background: #fff1f1;
  border-color: #b91c1c;
}

.bulk-edit-btn:hover {
  background: #f0f9ff;
  border-color: #2563eb;
}

/* 全ピン削除（赤文字強調） */
.header-item.danger { color:#ef4444; font-weight:700; }

/* ピンのポップアップUI */
.pin-title { font-weight: 700; margin-bottom: .5rem; }
.pin-actions { display: flex; gap: .5rem; flex-wrap: wrap; justify-content: center; /* ← 中央寄せ */}
.pin-btn {
  border: 1px solid #e5e7eb; border-radius: .5rem; padding: .35rem .6rem;
  font-size: .875rem; background: #fff; cursor: pointer;
}
.pin-btn:hover { background: #f3f4f6; }
.pin-btn.start { color: #16a34a; border-color: #bbf7d0; }  /* 出発地 */
.pin-btn.via   { color: #2563eb; border-color: #bfdbfe; }  /* 経由地 */
.pin-btn.goal  { color: #ef4444; border-color: #fecaca; }  /* 目的地 */

.pin-popup { min-width: 280px; }  /* 240→280で余裕を確保 */

.leaflet-popup-content .pin-actions {
  display: flex !important;
  gap: .4rem;
  flex-wrap: nowrap !important;   /* ← 折り返し禁止 */
  overflow-x: auto;               /* ← はみ出したら横スクロール */
  justify-content: center;
  align-items: center;
}

.leaflet-popup-content .pin-actions .pin-btn {
  display: inline-flex !important;
  flex: 0 0 auto;                 /* ← 伸縮させない */
  width: auto !important;
  min-width: auto !important;
  white-space: nowrap;
  padding: .3rem .5rem;           /* ← 少しだけタイトに */
  font-size: .82rem;              /* ← ほんのり縮小 */
}

/* 番号やS/Gの常時ツールチップがクリックを奪わないようにする */
.leaflet-tooltip {
  pointer-events: none !important;
}

/* ▼ 保険的なCSS（任意） */
.list-panel { 
  box-sizing: border-box; 
  overflow: hidden; 
}
#poi-list { 
  box-sizing: border-box; 
}

/* 検索バー内のベース高さを決める（バー自体の大きさは据え置き） */
.search-bar {
  min-height: 3rem;            /* 既存の見た目に近い高さのまま */
  padding: 0 .5rem;            /* 左右の余白だけ少し持たせる（0でもOK） */
  align-items: center;         /* 垂直センター揃え（再確認） */
}

/* 入力とボタン／アイコンを同じ高さ・縦中央に */
.search-input {
  height: 2.5rem;              /* 中の要素を揃える基準 */
  line-height: 2.5rem;         /* テキストの縦位置を中央に */
  padding: 0 .75rem;           /* 既存の余白を維持 */
}

/* 虫眼鏡アイコンにクラスが無い場合でも効くように、汎用的に対応 */
.search-bar svg,
.search-bar i,
.search-bar .icon,
.search-bar button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  height: 2.5rem;              /* 入力と同じ高さに */
  line-height: 1;              /* 余計な縦ズレを避ける */
}

/* ボタンの見た目を微調整（形は据え置き） */
.search-bar button {
  padding: 0 .9rem;
  border: none;                /* 既にボタンに枠があれば外す */
  background: transparent;     /* 既存デザインを尊重、必要なら #fff などに */
  border-radius: 9999px;
  cursor: pointer;
}

/* アイコンの大きさを安定させる（Material IconsやSVGの場合） */
.search-bar i,
.search-bar .material-icons,
.search-bar svg {
  width: 1.5rem;
  height: 1.5rem;
  font-size: 1.5rem;           /* iタグのアイコンフォント用 */
}

/* 強制的に持ち上げる */
.leaflet-bottom.leaflet-right .leaflet-control-zoom {
  margin-bottom: 6.5rem !important;
}

/* 検索バーのクリア× */
.search-bar { position: relative; }
.search-clear {
  position: absolute; right: 2.5rem; top: 50%; transform: translateY(-50%);
  width: 1.75rem; height: 1.75rem; border-radius: 9999px;
  display: none; align-items: center; justify-content: center;
  background: #f3f4f6; border: 1px solid #e5e7eb; cursor: pointer;
  font-weight: 700; color: #666; line-height: 1;
}
.search-clear:hover { background:#eee; }

.lock-btn{
  border:1px solid #e5e7eb; background:#fff; color:#444;
  width:2rem; height:2rem; border-radius:.5rem; cursor:pointer; flex-shrink:0;
}
.lock-btn:hover{ background:#f3f4f6; }

/* 削除ボタン（右端） */
.del-btn{
  border:1px solid #e5e7eb; background:#fff; color:#b91c1c;
  width:2rem; height:2rem; border-radius:.5rem; cursor:pointer; flex-shrink:0;
  margin-left:.5rem;
}
.del-btn:hover{ background:#fff1f1; }

/* 既存ロックボタンと高さ・配置を揃える */
.lock-btn{
  border:1px solid #e5e7eb; background:#fff; color:#444;
  width:2rem; height:2rem; border-radius:.5rem; cursor:pointer; flex-shrink:0;
  margin-left:.5rem; /* バッジとの間隔を少し */
}
.lock-btn:hover{ background:#f3f4f6; }

/* カード内の並びが詰まらないように微調整（必要なら） */
.poi-card{
  gap: .5rem;
}
.poi-content{
  min-width: 0; /* テキスト折返しのため */
}
.poi-name{
  overflow-wrap: anywhere;
}

/* --- 時間帯フィルターのON状態を可視化（最小） --- */
.header-item.is-active {
  background: #1d4ed8;
  color: #fff !important;
}

/* フィルター中に無効化する操作（見た目だけ） */
.header-item.is-disabled {
  opacity: .5;
  cursor: not-allowed;
}

/* リストカードの時間帯ストリップ（省スペース & 横スクロール） */
.poi-card .tw-strip{
  display: flex;
  gap: .4rem;
  flex-wrap: nowrap;          /* 折り返し禁止 */
  overflow-x: auto;           /* 横スクロール */
  -webkit-overflow-scrolling: touch;
  align-items: center;
  margin: .25rem 0 0;         /* 上下ギリギリ（上0.25remだけ） */
  padding: 0;
}
/* 横スクロール用ストリップのスクロールバーを消す */
.poi-card .tw-strip {
  scrollbar-width: none;     /* Firefox */
}
.poi-card .tw-strip::-webkit-scrollbar {
  display: none;             /* Chrome / Safari / Edge */
}

.poi-card .tw-strip .tw-btn{
  display: inline-flex;
  flex: 0 0 auto;             /* 伸縮させない＝横スクロール前提 */
  padding: .0rem .5rem;       /* ピンのポップアップと同等の最小サイズ */
  font-size: .82rem;          /* 同上 */
  border: 1px solid #e5e7eb;
  border-radius: .5rem;
  background: #fff;
  cursor: pointer;
  white-space: nowrap;
}
.poi-card .tw-strip .tw-btn:hover{ background: #f3f4f6; }

/* 時間帯ボタン（リスト版）の選択中状態を薄黄色に */
.poi-card .tw-strip .tw-btn.is-active {
  background: #fde68a;   /* コンビニ横の薄黄色と同じ色 */
  color: #000;           /* 読みやすく黒文字 */
  border-color: #fde68a;
}

/* ピンのポップアップ内：選択中の時間帯ボタンもバッジ色に */
.leaflet-popup-content .pin-actions .pin-btn.is-active {
  background:#fde68a;   /* バッジと同じ背景 */
  color:#000;        /* バッジと同じ文字色 */
  border-color:#fde68a;
  font-weight:600;
}

.poi-card .tw-strip .gmaps-btn {
  background-color: #fff;
  color: #000;
  font-weight: 500;
  border-radius: 7px;   /* 角を少しだけ丸める */
  padding: 0.1rem 0.3rem; /* ← 内側余白を極小に */
  
  border: 1px solid;
  border-color: #ea4335 #4285f4 #34a853 #fbbc05;
  /* 上 赤 / 右 青 / 下 緑 / 左 黄 */

  line-height: 1;       /* テキスト高さをギュッと詰める */
  font-size: 0.8rem;    /* 時間帯ボタンに近いサイズ */
}

.poi-card .tw-strip .edit-btn {
  background-color: #fff;
  color: #2563eb;
  font-weight: 500;
  border-radius: 7px;
  padding: 0.1rem 0.4rem;
  
  border: 1px solid #e5e7eb;
  
  line-height: 1;
  font-size: 0.9rem;
}

.poi-card .tw-strip .edit-btn:hover {
  background: #f0f9ff;
  border-color: #2563eb;
}

/* 編集・削除ボタン */
.pin-btn.edit   { color: #2563eb; }
.pin-btn.delete { color: #b91c1c; }

/* 目的地と編集ボタンの間にスペース */
.pin-btn.goal { margin-right: .5rem; }

/* Gマップボタン（インライン版・時間帯と同じスタイル） */
.pin-btn.gmaps-inline {
  background-color: #fff;
  color: #000;
  font-weight: 500;
  border-radius: 6px;
  padding: 0.3rem 0.5rem;
  border: 2px solid;
  border-color: #ea4335 #4285f4 #34a853 #fbbc05;
}

/* ステータスバッジ */
.status-badge {
  display: inline-block;
  margin-left: .5rem;
  font-size: .9rem;
  font-weight: 700;
}

.status-success { color: #22c55e; }    /* 緑 */
.status-partial { color: #eab308; }    /* 黄 */
.status-failed { color: #9ca3af; }     /* グレー */

/* 住所編集モーダル */
.edit-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 10000;
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
}

.modal-content {
  position: relative;
  background: #fff;
  border-radius: .75rem;
  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  width: 90%;
  max-width: 480px;
  z-index: 1;
}

.modal-header {
  padding: 1rem 1.25rem;
  border-bottom: 1px solid #e5e7eb;
}

.modal-title {
  font-size: 1.125rem;
  font-weight: 700;
  color: #111827;
}

.modal-body {
  padding: 1.25rem;
}

.modal-input {
  width: 100%;
  padding: .75rem;
  border: 2px solid #e5e7eb;
  border-radius: .5rem;
  font-size: 1rem;
  margin-bottom: .75rem;
  box-sizing: border-box;
}

.modal-input:focus {
  outline: none;
  border-color: #2563eb;
  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
}

.modal-status {
  font-size: .875rem;
  color: #6b7280;
  padding: .5rem;
  background: #f9fafb;
  border-radius: .375rem;
}

.modal-actions {
  padding: 1rem 1.25rem;
  border-top: 1px solid #e5e7eb;
  display: flex;
  gap: .75rem;
  justify-content: flex-end;
}

.modal-btn {
  padding: .625rem 1.25rem;
  border-radius: .5rem;
  font-size: .875rem;
  font-weight: 600;
  cursor: pointer;
  border: none;
}

.modal-btn.cancel {
  background: #fff;
  color: #374151;
  border: 1px solid #d1d5db;
}

.modal-btn.cancel:hover {
  background: #f9fafb;
}

.modal-btn.search {
  background: #2563eb;
  color: #fff;
}

.modal-btn.search:hover {
  background: #1d4ed8;
}

/* ヘルプアイコン */
.help-icon {
  font-size: 0.65rem;
  margin-left: 0.2rem;
  cursor: help;
  opacity: 0.7;
  font-weight: 400;
}

.help-icon:hover {
  opacity: 1;
}