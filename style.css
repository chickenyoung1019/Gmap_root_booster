html,body { height:100%; }
body { margin:0; padding:0; overflow:hidden; font-family:'Inter',system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN","Noto Sans JP","Yu Gothic","Meiryo",sans-serif; }
.wrapper { display:flex; flex-direction:column; height:100vh; width:100vw; }
#map { flex:1 1 auto; height:100%; width:100%; z-index:1; }

/* 下部リストパネル */
.list-panel{
  position:absolute; bottom:0; left:0; right:0; z-index:10; background:#fff;
  border-top-left-radius:1.5rem; border-top-right-radius:1.5rem;
  box-shadow:0 -4px 12px rgba(0,0,0,.15);
  transform:translateY(calc(100% - 4.5rem)); transition:transform .3s ease-in-out;
  display:flex; flex-direction:column; height:90vh; will-change:transform;
}
.list-panel.open{ transform:translateY(0); }
.handle-bar{ width:3rem; height:.25rem; background:#ccc; border-radius:.25rem; margin:.5rem auto 1rem; }
.list-header{ padding:.5rem 1rem; text-align:center; cursor:pointer; }
.list-content{ flex:1 1 auto; overflow-y:auto; padding:.75rem 1rem; background:#f7f7f7; }

.poi-card{ display:flex; align-items:center; gap:.75rem; padding:.1rem; border-radius:.5rem; background:#fff; box-shadow:0 1px 3px rgba(0,0,0,.1); margin-bottom:.15rem; cursor:grab; }
.poi-card:hover{ background:#f9f9f9; box-shadow:0 2px 6px rgba(0,0,0,.15); transform:translateY(-2px); }
.badge{ min-width:2.25rem; height:2.25rem; display:grid; place-items:center; font-weight:700; color:#fff; border-radius:9999px; font-size:.875rem; background:#4285F4; border:2px solid #fff; }
.poi-content{ display:flex; flex-direction:column; flex:1 1 auto; }
.poi-name{ font-weight:600; font-size:1rem; color:#333; }
.poi-meta{ font-size:.75rem; color:#777; }
.tw-badge{ display:inline-block; margin-left:.5rem; padding:.125rem .5rem; border-radius:.25rem; background:#fff3e0; color:#F8B400; font-weight:700; font-size:.75rem; border:1px solid #ffcc80; }

/* 画面上部のUI */
.header{ position:absolute; top:1rem; left:1rem; right:1rem; z-index:1000; display:flex; flex-direction:column; gap:.5rem; align-items:center; }
.search-bar{
  width:100%;
  max-width:600px;
  margin:0 auto;
  background:#fff;
  border-radius:12px;
  padding:0 1rem;
  box-shadow:0 2px 4px rgba(0,0,0,.2);
  display:flex;
  align-items:center;
  gap:.75rem;
  color:#777;
  min-height:44px;
  position:relative;
}
.address-fields{
  display:flex;
  align-items:center;
  gap:.5rem;
  flex:1 1 auto;
  min-width:0;
}
.address-field{
  position:relative;
  flex:1 1 0;
  min-width:0;
  display:flex;
  align-items:center;
}
.address-field--chome{ flex:1.2 1 0; }
.address-input{
  width:100%;
  border:none;
  outline:none;
  font-size:1rem;
  color:#333;
  background:transparent;
  height:44px;
  line-height:44px;
  padding:0 .5rem;
}
.address-input:disabled{ color:#9ca3af; cursor:not-allowed; }
.address-input::placeholder{ color:#a1a1aa; }
.combo-suggest{
  position:absolute;
  top:100%;
  left:0;
  right:0;
  margin-top:.25rem;
  background:#fff;
  border-radius:.75rem;
  box-shadow:0 10px 24px rgba(0,0,0,.18);
  display:none;
  z-index:1200;
  max-height:18rem;
  overflow-y:auto;
}
.combo-suggest.is-open{ display:block; }
.combo-suggest button{
  width:100%;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:.5rem;
  padding:.45rem .75rem;
  border:none;
  background:#fff;
  cursor:pointer;
  font-size:.95rem;
  color:#111827;
}
.combo-suggest button span:first-child{
  flex:1 1 auto;
  text-align:left;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.combo-suggest button:hover,
.combo-suggest button:focus,
.combo-suggest button.is-active{ background:#eef2ff; outline:none; }
.combo-suggest .suggest-yomi{ font-size:.75rem; color:#6b7280; margin-left:auto; }
.chome-chips{
  display:flex;
  align-items:center;
  flex-wrap:wrap;
  gap:.4rem;
  min-height:44px;
  padding:0 .25rem;
  font-size:.85rem;
  color:#6b7280;
}
.chome-chips.empty{ color:#9ca3af; }
.chome-chip{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  border:1px solid #d1d5db;
  border-radius:9999px;
  min-height:32px;
  padding:0 .65rem;
  background:#fff;
  color:#111827;
  cursor:pointer;
  font-size:.85rem;
  transition:background .15s ease, color .15s ease;
}
.chome-chip:hover{ background:#eef2ff; }
.chome-chip.is-active{
  background:#2563eb;
  color:#fff;
  border-color:#2563eb;
}
.chome-note{ font-size:.72rem; color:#9ca3af; }
.chome-placeholder{ color:#9ca3af; }
.address-search-btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  height:44px;
  padding:0 1.25rem;
  border-radius:10px;
  background:#2563eb;
  color:#fff;
  font-weight:600;
  font-size:.95rem;
  border:none;
  cursor:pointer;
  flex-shrink:0;
  transition:background .2s ease;
}
.address-search-btn:disabled{
  background:#c7d2fe;
  cursor:not-allowed;
  opacity:.85;
}
.address-search-btn:not(:disabled):hover{ background:#1d4ed8; }
.address-search-btn.is-disabled{
  pointer-events:none;
  opacity:.65;
}
.btn-container{ display:flex; align-items:center; gap:.5rem; width:100%; overflow-x:auto; white-space:nowrap; -webkit-overflow-scrolling:touch; }
.header-item{ display:inline-flex; align-items:center; justify-content:center; height:2rem; padding:0 1rem; border-radius:9999px; background:#fff; color:#333; font-size:.875rem; font-weight:500; box-shadow:0 1px 3px rgba(0,0,0,.1); cursor:pointer; flex-shrink:0; }

/* 番号バッジ（常時表示ツールチップ用） */
.idx-tip{
  background:#1d4ed8; color:#fff; font-weight:700; font-size:12px;
  border-radius:9999px; padding:2px 6px; border:2px solid #fff;
  box-shadow:0 1px 3px rgba(0,0,0,.2);
}

/* アクティブ強調（ピンの赤縁） */
.leaflet-marker-icon.active {
  filter: drop-shadow(0 0 1px #ff0000) drop-shadow(0 0 1px #ff0000) drop-shadow(0 0 1px #ff0000);
}

/* Leaflet のポップアップ（ピンの吹き出し） */
.leaflet-popup-content {
  font-size: 1.05rem;  /* デフォルト12px→14px相当 */
  font-weight: 600;    /* 太字寄りに */
}

/* S/G バッジ（LeafletのTooltipを利用） */
.sg-tip-start {
  background:#22c55e; color:#fff; font-weight:700; font-size:12px;
  border-radius:9999px; padding:2px 6px; border:2px solid #fff;
  box-shadow:0 1px 3px rgba(0,0,0,.2);
}
.sg-tip-goal {
  background:#ef4444; color:#fff; font-weight:700; font-size:12px;
  border-radius:9999px; padding:2px 6px; border:2px solid #fff;
  box-shadow:0 1px 3px rgba(0,0,0,.2);
}

/* 一括/コピペパネル */
#bulkPanel {
  position: absolute; left: 1rem; right: 1rem; top: 4.25rem; z-index: 1001;
  background: #fff; border-radius: .75rem; box-shadow: 0 10px 24px rgba(0,0,0,.18);
  padding: .75rem; display: none;
}
#bulkPanel .row { display:flex; gap:.5rem; flex-wrap:wrap; align-items:center; margin-bottom:.5rem; }
#bulkPanel textarea { width:100%; min-height: 30rem; border:1px solid #e5e7eb; border-radius:.5rem; padding:.5rem; font-size:.95rem; }
#bulkPanel .pill { padding:.4rem .8rem; border:1px solid #dadce0; border-radius:9999px; background:#fff; cursor:pointer; }
#bulkPanel .pill:hover { background:#f5f7ff; }
#bulkPanel small { color:#6b7280; }

/* 全ピン削除（赤文字強調） */
.header-item.danger { color:#ef4444; font-weight:700; }

/* ピンのポップアップUI */
.pin-title { font-weight: 700; margin-bottom: .5rem; }
.pin-actions { display: flex; gap: .5rem; flex-wrap: wrap; justify-content: center; /* ← 中央寄せ */}
.pin-btn {
  border: 1px solid #e5e7eb; border-radius: .5rem; padding: .35rem .6rem;
  font-size: .875rem; background: #fff; cursor: pointer;
}
.pin-btn:hover { background: #f3f4f6; }
.pin-btn.start { color: #16a34a; border-color: #bbf7d0; }  /* 出発地 */
.pin-btn.via   { color: #2563eb; border-color: #bfdbfe; }  /* 経由地 */
.pin-btn.goal  { color: #ef4444; border-color: #fecaca; }  /* 目的地 */
.pin-btn.c     { color: #6b7280; }                          /* C（暫定） */

.pin-popup { min-width: 280px; }  /* 240→280で余裕を確保 */

.leaflet-popup-content .pin-actions {
  display: flex !important;
  gap: .4rem;
  flex-wrap: nowrap !important;   /* ← 折り返し禁止 */
  overflow-x: auto;               /* ← はみ出したら横スクロール */
  justify-content: center;
  align-items: center;
}

.leaflet-popup-content .pin-actions .pin-btn {
  display: inline-flex !important;
  flex: 0 0 auto;                 /* ← 伸縮させない */
  width: auto !important;
  min-width: auto !important;
  white-space: nowrap;
  padding: .3rem .5rem;           /* ← 少しだけタイトに */
  font-size: .82rem;              /* ← ほんのり縮小 */
}

/* 番号やS/Gの常時ツールチップがクリックを奪わないようにする */
.leaflet-tooltip {
  pointer-events: none !important;
}

/* ▼ 保険的なCSS（任意） */
.list-panel { 
  box-sizing: border-box; 
  overflow: hidden; 
}
#poi-list { 
  box-sizing: border-box; 
}

/* 虫眼鏡アイコンにクラスが無い場合でも効くように、汎用的に対応 */
.search-bar svg,
.search-bar i,
.search-bar .icon,
.search-bar button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  height: 2.5rem;              /* 入力と同じ高さに */
  line-height: 1;              /* 余計な縦ズレを避ける */
}

/* アイコンの大きさを安定させる（Material IconsやSVGの場合） */
.search-bar i,
.search-bar .material-icons,
.search-bar svg {
  width: 1.5rem;
  height: 1.5rem;
  font-size: 1.5rem;           /* iタグのアイコンフォント用 */
}

/* 強制的に持ち上げる */
.leaflet-bottom.leaflet-right .leaflet-control-zoom {
  margin-bottom: 6.5rem !important;
}

.lock-btn{
  border:1px solid #e5e7eb; background:#fff; color:#444;
  width:2rem; height:2rem; border-radius:.5rem; cursor:pointer; flex-shrink:0;
}
.lock-btn:hover{ background:#f3f4f6; }

/* 削除ボタン（右端） */
.del-btn{
  border:1px solid #e5e7eb; background:#fff; color:#b91c1c;
  width:2rem; height:2rem; border-radius:.5rem; cursor:pointer; flex-shrink:0;
  margin-left:.5rem;
}
.del-btn:hover{ background:#fff1f1; }

/* 既存ロックボタンと高さ・配置を揃える */
.lock-btn{
  border:1px solid #e5e7eb; background:#fff; color:#444;
  width:2rem; height:2rem; border-radius:.5rem; cursor:pointer; flex-shrink:0;
  margin-left:.5rem; /* バッジとの間隔を少し */
}
.lock-btn:hover{ background:#f3f4f6; }

/* カード内の並びが詰まらないように微調整（必要なら） */
.poi-card{
  gap: .5rem;
}
.poi-content{
  min-width: 0; /* テキスト折返しのため */
}
.poi-name{
  overflow-wrap: anywhere;
}

/* --- 時間帯フィルターのON状態を可視化（最小） --- */
.header-item.is-active {
  background: #1d4ed8;
  color: #fff !important;
}

/* フィルター中に無効化する操作（見た目だけ最小） */
.header-item.is-disabled {
  opacity: .5;
  pointer-events: none;
}

/* リストカードの時間帯ストリップ（省スペース & 横スクロール） */
.poi-card .tw-strip{
  display: flex;
  gap: .4rem;
  flex-wrap: nowrap;          /* 折り返し禁止 */
  overflow-x: auto;           /* 横スクロール */
  -webkit-overflow-scrolling: touch;
  align-items: center;
  margin: .25rem 0 0;         /* 上下ギリギリ（上0.25remだけ） */
  padding: 0;
}
/* 横スクロール用ストリップのスクロールバーを消す */
.poi-card .tw-strip {
  scrollbar-width: none;     /* Firefox */
}
.poi-card .tw-strip::-webkit-scrollbar {
  display: none;             /* Chrome / Safari / Edge */
}

.poi-card .tw-strip .tw-btn{
  display: inline-flex;
  flex: 0 0 auto;             /* 伸縮させない＝横スクロール前提 */
  padding: .0rem .5rem;       /* ピンのポップアップと同等の最小サイズ */
  font-size: .82rem;          /* 同上 */
  border: 1px solid #e5e7eb;
  border-radius: .5rem;
  background: #fff;
  cursor: pointer;
  white-space: nowrap;
}
.poi-card .tw-strip .tw-btn:hover{ background: #f3f4f6; }

/* 時間帯ボタン（リスト版）の選択中状態を薄黄色に */
.poi-card .tw-strip .tw-btn.is-active {
  background: #fde68a;   /* コンビニ横の薄黄色と同じ色 */
  color: #000;           /* 読みやすく黒文字 */
  border-color: #fde68a;
}

/* ピンのポップアップ内：選択中の時間帯ボタンもバッジ色に */
.leaflet-popup-content .pin-actions .pin-btn.is-active {
  background:#fde68a;   /* バッジと同じ背景 */
  color:#000;        /* バッジと同じ文字色 */
  border-color:#fde68a;
  font-weight:600;
}

